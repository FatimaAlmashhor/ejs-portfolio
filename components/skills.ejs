<!-- Title -->

<div class="w-full flex justify-between ">
    <h1 class="text-2xl">Skills</h1>

    <!-- Skill Section -->
    <div @click="showSkills=true ; newModel = true" class=" cursor-pointer" id='skill_modal_btn'>
        <ion-icon name="add-outline"></ion-icon>
    </div>
</div>
<div class="w-full  flex flex-row flex-wrap">
    <% for( let index=0; index < data.length; index++ ) { %>
        <div class="overlay flex p-0  relative m-2">
            <!-- Overlay inner wrapper -->
            <div class="overlay__inner  min-w-fit p-2">
                <div x-data="{dropdownSkills: false}" class="relative w-full">
                    <div class="w-full flex justify-between  my-5 px-3  py-1">
                        <div class="">
                            <h3>
                                <%= data[index].skill_name %>
                            </h3>
                        </div>
                        <div class="cursor-pointer" @click="dropdownSkills = ! dropdownSkills">
                            <ion-icon name="ellipsis-vertical-outline"></ion-icon>
                        </div>
                    </div>

                    <!-- Dropdown list -->
                    <div x-show="dropdownSkills"
                        class="absolute z-50 right-0 py-2 mt-0 bg-white bg-gray-100 rounded-md shadow-xl w-44">
                        <button @click=" skill_id = '<%=data[index].id  %>' ;  fetchSkill() "
                            class="block px-4 py-2 text-sm text-gray-300 text-gray-700 hover:bg-gray-400 hover:text-white">
                            Edit
                        </button>
                        <a href="/dashboard/skills/delete/
                        <%= data[index].id  %>
                        " data-id-delete="
                            <%= data[index].id  %>
                            "
                            class="block px-4 py-2 text-sm text-red-600 text-gray-700 hover:bg-gray-400 hover:text-white">
                            Delete
                        </a>

                    </div>

                </div>
            </div>
        </div>

        <% } %>
</div>
<script>
    const deleteBtn = document.querySelectorAll('[data-id-delete]')
    deleteBtn.forEach(element => {
        element.addEventListener('click', () => onClickDelete(element))
    })
    async function onClickDelete(e) {
        var id = e.getAttribute('data-id-delete').replace(/ /g, "");
        await fetch(`http://localhost:3000/dashboard/skills/delete/${id}`, {
            method: 'DELETE',

        }).then(result => {
            return result.json();
        }).then(re => {

        });
    }
    function showme() {
        return {
            is_loading: false,
            skill_name: '',
            Skill_type: '',
            fetchSkill() {
                this.showSkills = true
                this.is_loading = true;
                this.newModel = false;
                fetch(`http://localhost:3000/dashboard/skills/${this.skill_id}`)
                    .then(res => res.json())
                    .then(data => {
                        this.isLoading = false;
                        this.skill_name = data.formInfo.skill_name;
                        this.skill_type = data.formInfo.skill_type;
                        console.log(data);
                    });
            }
        }
    }
</script>